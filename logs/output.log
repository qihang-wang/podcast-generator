2026-01-20 17:46:23,914 - INFO - ============================================================
2026-01-20 17:46:23,914 - INFO - ğŸš€ GDELT æ–°é—»æ•°æ®è·å–ä¸ç”Ÿæˆ
2026-01-20 17:46:23,914 - INFO - ============================================================
2026-01-20 17:46:23,914 - INFO - 
================================================================================
2026-01-20 17:46:23,914 - INFO - ğŸš€ å¼€å§‹ GKG æ•°æ®ç›´æ¥è·å–
2026-01-20 17:46:23,915 - INFO - ================================================================================
2026-01-20 17:46:23,915 - INFO - 
ğŸ“ å‚æ•°: country=CH, hours=24h, limit=20
2026-01-20 17:46:23,915 - INFO - 
ğŸ” æŸ¥è¯¢ GKG è¡¨...
2026-01-20 17:46:23,940 - INFO - [2026-01-20 17:46:23.940855] å¼€å§‹æŸ¥è¯¢ GKG è¡¨...
2026-01-20 17:46:23,941 - INFO - 
[DEBUG] SQL Query:
2026-01-20 17:46:23,941 - INFO - ================================================================================
2026-01-20 17:46:23,941 - INFO - SELECT
  GKGRECORDID, DATE, SourceCommonName, DocumentIdentifier,
  V2Themes, V2Locations, V2Persons, V2Organizations,
  V2Tone, Amounts, Quotations, GCAM,
  SocialImageEmbeds, SocialVideoEmbeds,
  REGEXP_EXTRACT(Extras, r'<PAGE_TITLE>(.*?)</PAGE_TITLE>') AS Article_Title,
  REGEXP_EXTRACT(Extras, r'<PAGE_AUTHORS>(.*?)</PAGE_AUTHORS>') AS Authors

FROM `gdelt-bq.gdeltv2.gkg_partitioned`
WHERE _PARTITIONTIME >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 1 DAY) AND DATE >= CAST(FORMAT_TIMESTAMP('%Y%m%d%H%M%S', TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 24 HOUR)) AS INT64) AND (
      -- è®¡ç®—ç›®æ ‡å›½å®¶åœ¨æ‰€æœ‰åœ°ç‚¹ä¸­çš„å æ¯”
      SAFE_DIVIDE(
        (SELECT COUNT(1) FROM UNNEST(SPLIT(V2Locations, ';')) AS loc 
         WHERE SPLIT(loc, '#')[SAFE_OFFSET(2)] IN ('CH')),
        ARRAY_LENGTH(SPLIT(V2Locations, ';'))
      ) >= 0.3
    ) AND CAST(SPLIT(V2Tone, ',')[SAFE_OFFSET(6)] AS INT64) >= 200 AND (
      TranslationInfo IS NULL 
      OR REGEXP_EXTRACT(TranslationInfo, 'srclc:(.*?);') IN ('eng', 'zho', 'spa', 'fra', 'deu', 'rus', 'jpn', 'kor', 'por', 'ara')
    ) AND (
      -- æƒ…æ„Ÿæç«¯æ€§ï¼šæ­£é¢>5.0 æˆ–è´Ÿé¢<-5.0
      CAST(SPLIT(V2Tone, ',')[SAFE_OFFSET(0)] AS FLOAT64) > 5.0
      OR CAST(SPLIT(V2Tone, ',')[SAFE_OFFSET(0)] AS FLOAT64) < -5.0
    )
ORDER BY DATE DESC
LIMIT 20
2026-01-20 17:46:23,942 - INFO - ================================================================================
